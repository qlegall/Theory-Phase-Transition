%Report template

\documentclass[10pt,a4paper]{amsart}

% Class options



\usepackage[utf8]{inputenc}
\usepackage{enumitem}
%\usepackage[latin1]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{amsmath,amssymb, amsfonts, amsthm, stmaryrd, enumitem, mathtools}
\usepackage{ifpdf}
%\usepackage{natbib}
%\usepackage{mathabx} % bigtimes
\usepackage{mathrsfs} % mathscr
\usepackage{subfig}
\usepackage{float}
\usepackage{color}
\usepackage{hyperref}
% plotting
\usepackage{pgfplots}
\pgfplotsset{compat=newest}
\pgfplotsset{every axis legend/.append style={
at={(0,0)},
anchor=north east}} 


% abbreviations
%\usepackage[intoc]{nomencl}
%\renewcommand{\nomname}{Notations}



% Modify top margin 
%\setlength{\topmargin}{-15mm}

% Theorems, definitions...
\usepackage{amsthm}
\usepackage{bbm}

\newtheoremstyle{exampstyle}
{15pt} % Space above
{15pt} % Space below
{} % Body font. Remove itshape if want texts of theorems normal and not in italics
{} % Indent amount
{\bfseries} % Theorem head font
{.} % Punctuation after theorem head
{.5em} % Space after theorem head
{} % Theorem head spec (can be left empty, meaning `normal')

\theoremstyle{exampstyle}

\newtheorem{Theorem}{Theorem}
\newtheorem{Definition}{Definition}
\newtheorem{Lemma}{Lemma}
\newtheorem{Remark}{Remark}
\newtheorem{Example}{Example}
\newtheorem{Corollary}{Corollary}
\newtheorem{Proposition}{Proposition}
%\newtheorem{Notation}{Notation}
\newenvironment{Proof}{\noindent{\textit{Proof.}}}{%
\hspace*{\fill}$\Box$\par\vskip2ex}
\newcommand{\bspend}{%
\hspace*{\fill}$\blacktriangleleft$\par\vskip2ex}
\newcommand{\bewend}{%
\hspace*{\fill}$\Box$\par\vskip2ex}

%\newtheorem{Theorem}[Theorem]{Theorem}
%\newtheorem{Definition}[Theorem]{Definition}
%\newtheorem{Lemma}[Theorem]{Lemma}
%\newtheorem{Remark}[Theorem]{Remark}
%\newtheorem{Example}[Theorem]{Example}
%\newtheorem{Corollary}[Theorem]{Corollary}
%\newtheorem{Proposition}[Theorem]{Proposition}
%\newtheorem{Notation}{Notation}
%\newenvironment{Proof}{\noindent{\textit{Proof.}}}{%
%\hspace*{\fill}$\Box$\par\vskip2ex}
%\newcommand{\bspend}{%
%\hspace*{\fill}$\blacktriangleleft$\par\vskip2ex}
%\newcommand{\bewend}{%
%\hspace*{\fill}$\Box$\par\vskip2ex}

\newtheoremstyle{exampnotations}
{15pt} % Space above
{15pt} % Space below
{} % Body font. Remove itshape if want texts of theorems normal and not in italics
{} % Indent amount
{\bfseries} % Theorem head font
{.} % Punctuation after theorem head
{.5em} % Space after theorem head
{} % Theorem head spec (can be left empty, meaning `normal')

\theoremstyle{exampnotations}  
\newtheorem{Notation}{Notation}

\usepackage{caption}

\usepackage{newclude}

\usepackage[final]{pdfpages}

\usepackage{fancyhdr}
\fancyhead{}
\fancyhead[RO]{\slshape \rightmark}
%\fancyhead[LE]{\slshape \leftmark}

%\allowdisplaybreaks
% instead: single \displaybreak in align-environment

\usepackage{hyperref}
%\hypersetup{
% colorlinks,
% citecolor=black,
% filecolor=black,
% linkcolor=black,
% urlcolor=black
%}

% macros
\newcommand{\rpos}{\mathbb{R}_\geq}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\kn}{\kappa_n}
\newcommand{\pl}{\left( \left\{ }
\newcommand{\pr}{ \right\} \right) }
\newcommand{\supt}{\sup_{0\leq t \leq T}}
\newcommand{\il}{\left( } % integrals
\newcommand{\ir}{\right) }
\newcommand{\Il}{\Bigg(} % integrals
\newcommand{\Ir}{\Bigg)}
\newcommand{\el}{\left[ }
\newcommand{\er}{\right] }
\newcommand{\El}{\Bigg[ }
\newcommand{\Er}{\Bigg] }
\newcommand{\rl}{\left(}
\newcommand{\rr}{\right)}
\newcommand{\Rl}{\Bigg(}
\newcommand{\Rr}{\Bigg)}
\newcommand{\vl}{\left|}
\newcommand{\vr}{\right|}
\newcommand\floor[1]{\lfloor#1\rfloor}
\newcommand\ceil[1]{\lceil#1\rceil}
\newcommand{\indep}{\rotatebox[origin=c]{90}{$\models$}}

%\makenomenclature

% Hyphenation
\hyphenation{Lip-schitz}
\hyphenation{sto-chas-tic}
\hyphenation{nu-me-ri-cal}
\hyphenation{appro-xi-ma-tion}
\hyphenation{accor-ding}
\hyphenation{mathematics}
\hyphenation{in-equa-li-ty}
\hyphenation{in-equa-li-ties}
\hyphenation{mea-sura-bi-li-ty}
\hyphenation{Brownian}
\hyphenation{Example}
\hyphenation{si-mu-la-tion}
\hyphenation{si-mu-la-tions}

% Appendices
%\usepackage[toc,page]{appendix}



% Colours
\definecolor{dark1}{RGB}{27, 158, 119}
\definecolor{dark2}{RGB}{217, 95, 2}
\definecolor{dark3}{RGB}{117, 112, 179}
\definecolor{dark4}{RGB}{231, 41, 138}  

%\usepackage{chngcntr}
%\counterwithout{footnote}{chapter}

\newcommand{\vertiii}[1]{{\left\vert\kern-0.25ex\left\vert\kern-0.25ex\left\vert #1 \right\vert\kern-0.25ex\right\vert\kern-0.25ex\right\vert}}

%\usepackage{tocloft}
%\setlength\cftbeforefigskip{\cftbeforechapskip}
%\setlength\cftbeforetabskip{\cftbeforechapskip}

\begin{document}
\title{Percolation for Cox Point Processes with Canyon Shadowing}
\author{Quentin Le Gall}
\address{Orange Labs Networks, 44 avenue de la RÃ©publique 92320 Ch\^atillon}
\email{quentin1.legall@orange.com}
\author{Bart\l{}omiej B\l{}aszczyszyn}
\address{Inria - \MakeUppercase{ens}, 2 rue Simone Iff CS42112 75589 Paris Cedex 12}
\email{bartek.blaszczyszyn@ens.fr }
\maketitle
\tableofcontents
\section{Foreword}
\subsection{Network model}
\label{Ss.NetworkModel}
Consider a probability space $(\Omega, \mathcal{F}, \mathbb{P})$ and state space $(\mathbb{R}^{2}, \mathcal{B}(\mathbb{R}^{2}))$, where $\mathcal{B}(\mathbb{R}^{2})$ is the usual Borel $\sigma$-algebra of $\mathbb{R}^{2}$. \\

Let $\lambda_{S} > 0$ and $X_{S}$ be a homogeneous planar Poisson point process (PPP) in the state space $\mathbb{R}^{2}$ with intensity $\lambda_S$. Consider the Poisson-Voronoi tessellation (PVT) $S$ associated with $X_S$. In particular, $S$ is stationary. By analogy with a telecommunications network, $S$ will be called \emph{street system} from now owards. \\
\indent Denote by $E \coloneqq (E_{i})_{i \geq 1}$ the edge-set of $S$ and by $V \coloneqq (V_{i})_{i \geq 1}$ the vertex-set of $V$. Furthering the aforementioned analogy, the elements of $E$ (resp. $V$) will be called \emph{street segments} (resp. \emph{crossroads}). \\
\indent Let $\Lambda$ be the stationary random measure defined such that:
\begin{itemize}
\item $\mathbb{E} \Lambda \left[0,1\right]^{2} = 1$
\item $\Lambda(dx) = \nu_{1}(S \cap dx)$, where $\nu_{1}$ denotes the 1-dimensional Hausdorff measure of $\mathbb{R}^{2}$. In other words, $\nu_{1}(S \cap B)$ is the total edge length of $S$ contained in the Borel observation window $B$ and so $\Lambda$ can be seen as a Lebesgue-like measure on the edges of $S$, rescaled in such a way that the total $\Lambda$-measure of a 1-area window is 1. \\
\end{itemize}

The key network parameters are:
\begin{itemize}
\item The user density $\lambda > 0$.
\item The relay proportion $p \in \left(0,1\right)$.
\item The connectivity radius $r > 0$. \\
\end{itemize}

The users, equipped with mobile devices, are modelled by a Cox process $X^{\lambda}$ driven by the random intensity measure $\lambda \Lambda$. In other words, conditioned on a given realization of the street system $S$, $X^{\lambda}$ is a PPP with mean measure $\lambda \Lambda$. In particular, the number of users on a given street segment $e \in E$ is a Poisson random variable with mean $\nu_{1}(e)$ and the numbers of users in two disjoint subsets of $E$ are independent random variables. \\
\indent The relays (either representing physical antennas or additional users not modelled through $X^{\lambda}$) are modelled by a Bernoulli point process $Y$ on the set of crossroads $V$ with parameter $p$, so that one can write:
\begin{equation*}
Y = \sum_{i} \mathbbm{1}_{\lbrace U_{i} \leq p \rbrace } \delta_{V_{i}},
\end{equation*}
where $U_{i} \;\substack{ \text{i.i.d.} \\ \sim} \; \mathcal{U}(0,1)$ and where $\delta_{x}$ denotes the Dirac measure at $x$. In other words, each crossroad is retained (resp. erased) independently from all others with probability $p$ (resp. $1-p$). \\
\noindent Moreover, we also assume that the processes of users and of relays are independent, i.e. $X^{\lambda} \indep Y$. We denote $Z \coloneqq X^{\lambda} \cup Y$ the superposition of users and relays. \\

The network is modelled by the \emph{connectivity graph} $\mathcal{G}_{r,\lambda,p}$ defined in the following way:
\begin{itemize}
\item $\mathcal{G}_{r,\lambda,p}$ is undirected.
\item The vertex set of $\mathcal{G}_{r,\lambda,p}$ are the points of $Z$.
\item The edge $Z_{i} \leftrightsquigarrow Z_{j}, i \neq j$ is drawn if and only if $Z_{i}$ and $Z_{j}$ are located on the \emph{same} street segment and of mutual Euclidean distance less than $r$. In other words:
\begin{equation}
\label{connectivity_mechanism}
\forall \, i \neq j, \: Z_{i} \leftrightsquigarrow Z_{j} \Leftrightarrow 
\left\{
\begin{array}{l}
\exists \, e \in E, \, Z_{i} \in E  \  \text{and} \  Z_{j} \in E \\
\lVert Z_{i} - Z_{j} \rVert \leq r
\end{array}
\right.
\end{equation}
\end{itemize}

%\begin{Remark}
%The connectivity mechanism defined by \eqref{connectivity_mechanism} only allows for so-called line-of-sight (LOS) connections, which can be seen as a modelling of physical obstacles preventing connections to occur in all directions.
%\end{Remark}

\paragraph*{Main question :} Percolation regime of the connectivity graph $\mathcal{G}_{r,\lambda, p}$? Are there critical values of the parameters $(r,\lambda,p)$ for which percolation of $\mathcal{G}_{r,\lambda, p}$ occurs with positive probability?

\subsection{Definitions and Notations}
We begin with introducing a few notations and definitions useful for the purposes of our developments.
 \begin{Notation}
 For $A \subset \mathbb{R}^{2}$ and $B \subset \mathbb{R}^{2}$, we denote as customary the Euclidean distance between $A$ and $B$ by:
 $$\text{dist}(A,B) \coloneqq \inf \lbrace \lVert x - y \rVert_{2} , \,  x \in A, \,  y \in B \rbrace$$
 \end{Notation}

\begin{Notation}
For $x \in \mathbb{R}^{2}$, $n \in \mathbb{N} \setminus \lbrace 0 \rbrace$, we denote by $$Q_n(x) \coloneqq x + \left[-n/2,n/2\right]^{2}$$ the square of side $n$ centered at $x$. We note that this is exactly the definition of the closed ball with center $x$ and radius $n/2$ for the infinite norm of $\mathbb{R}$
\end{Notation}

\begin{Notation}
For $n \in \mathbb{N} \setminus \lbrace 0 \rbrace$, we will write 
$Q_n$ to mean $Q_n(0)$.
\end{Notation}

\begin{Notation}
We denote by $\mathbf{M}$ the space of Borel measures on $\mathbb{R}^{2}$, equipped with the evalutation $\sigma$-algebra \cite[Section 13.1]{last2017lectures}, i.e. the smallest $\sigma$-algebra making the mappings $\Xi \mapsto \Xi(B)$ measurable for all Borel sets $B \subset \mathbb{R}^{d}$.
\end{Notation}

\begin{Notation}
For a (possibly random) Borel measure $\mu$ on $\mathbb{R}^{2}$ and $A \subset \mathbb{R}^{2}$, we denote the restriction of $\mu$ to $A$ by: $$\mu_A(\cdot) \coloneqq \mu(A \cap \cdot)$$
\end{Notation}

Finally, we will use the following convenient notation for the length of a street segment or a subset of street segment:
\begin{Notation}
Let $e \in E$ and $s \subseteq e$. Then we denote the length of $s$ by $\vert s \vert$.
\end{Notation}

\begin{Definition}
Let $\mu$ be a (possibly random) Borel measure on $\mathbb{R}^{2}$. The \emph{support} of $\mu$ is the following set:
$$\text{supp}(\mu) \coloneqq \lbrace x \in \mathbb{R}^{d} \, : \forall \varepsilon > 0, \,  \mu(Q_{\varepsilon}(x)) > 0 \rbrace$$
\end{Definition}
We will then need the concepts of \emph{stabilization} and \emph{essential asymptotical connectedness} given in \cite{hirsch_continuum_2017} for investigating spatial dependencies of random measures:

\begin{Definition}
\label{Def.stabilizing}
A random measure $\Xi$ on $\mathbb{R}^{2}$ is called \emph{stabilizing} if there exists a random field of stabilisation radii $R = \lbrace R_{x} \rbrace _{x \in \mathbb{R}^{2}}$ defined on the same probability space as $\Xi$ such that:
\begin{enumerate}[label = (\arabic*)]
\item $(\Xi,R)$ are jointly stationary
\item $\displaystyle \lim_{n \uparrow \infty} \mathbb{P}\left(\sup _{y \in Q_{n} \cap \mathbb{Q}^{2}} R_{y} < n\right) = 1$
\item for all $n \geq 1$, the random variables 
$$ \left\lbrace f\left(\Xi_{Q_{n}(x)}\right)\mathbbm{1}\left\lbrace \sup_{y \in Q_{n}(x) \cap \mathbb{Q}^{2}} R_{y} < n \right\rbrace \right\rbrace _{x \in \varphi}$$
are independent for all bounded measurable functions $$f : \mathbf{M} \to \left[0, +\infty \right)$$ and finite $\varphi \subset \mathbb{R}^{2}$ such that $\forall \, x \in \varphi, \, \text{dist}(x, \varphi \setminus \lbrace x \rbrace ) > 3n$.
\end{enumerate}
\end{Definition}
\begin{Remark}
Throughout the rest of this paper, we assume the random variables $(R_x)_{x \in \mathbb{R}^{2}}$ to be $\Lambda$-measurable, as has been done by the authors of \cite{hirsch_continuum_2017}.
\end{Remark}
\begin{Remark}
In the above definition, the random field of stabilization radii $R = \lbrace R_{x} \rbrace _{x \in \mathbb{R}^{2}}$ may not be unique, i.e. a random measure can be stabilizing for more than one field of stabilization radii.
\end{Remark}
\begin{Remark}
Let $b > 0$ and assume that $\Xi$ is $b$-dependent, i.e. $$\forall A,B \subset \mathbb{R}^{d}, \, \text{dist}(A,B) > b \Rightarrow \Xi_{A} \indep \Xi_{B}$$ Then $\Xi$ is stabilizing. 
\end{Remark} 

\begin{Definition}[Essentially asymptotically connected random measure]
Let $\Xi$ be a random measure. Then $\Xi$ is \emph{essentially asymptotically connected} if there exists a random field $R = \lbrace R_{x} \rbrace_{x \in \mathbb{R}^{d}}$ such that $\Lambda$ is stabilizing for $R$ and if for all $n \geq 1$, whenever $\displaystyle \sup_{y \in Q_{2n} \cap \mathbb{Q}^{2}} R_{y} < n/2$, the following assertions are satisfied:
\begin{enumerate}[label = (\arabic*)]
\item $\text{supp}(\Xi_{Q_{n}}) \neq \emptyset$
\item $\text{supp}(\Xi_{Q_{n}})$ is contained in a connected component of $\text{supp}(\Xi_{Q_{2n}})$
\end{enumerate}
\end{Definition}

The following result from \cite{hirsch_continuum_2017} will turn out to be useful for our purposes:

\begin{Proposition}
Let $\Lambda = \nu_{1}(S \cap dx)$, where $S$ is the PVT generated by an homogeneous stationary Poisson. Then $\Lambda$ is stabilizing and essentially asymptotically connected for the following stabilization field:
$$\forall x \in \mathbb{R}^{2}, \, R_x = \inf \lbrace \lVert x - X_{S,i} \rVert , \, X_{S,i} \in X_{S} \rbrace,$$
where $X_S$ is the PPP having generated $S$.
\end{Proposition}

We will need the following notation for convenience:

\begin{Notation}
Assume that $\Xi$ is a stabilizing random measure for the stabilization field $R = \lbrace R_x \rbrace _{x \in \mathbb{R}^{2}}.$ Then, for $x \in \mathbb{R}^{2}$ and $n \in \mathbb{N}\setminus \lbrace 0 \rbrace$ we denote:
$$R(Q_n(x)) \coloneqq \sup_{y \in Q_n(x) \cap \mathbb{Q}^{2}} R_y$$
\end{Notation}

Finally, we will adapt the usual definitions of openness and closedness of crossroads and parts of street segments (possibly the whole street segments themselves) in our model as follows:

\begin{Definition}[Open/Closed crossroad]
Say a crossroad $V_{i} \in V$ is \emph{open} if it is an atom of the point process $Y$, i.e. $Y(\lbrace V_i \rbrace) = 1$, or, equivalently, $U_i \leq p$. \\ Say $V_{i}$ is \emph{closed} if it is not open, i.e. $Y(\lbrace V_i \rbrace) = 0$, or, equivalently, $U_i > p$.
\end{Definition}

\begin{Definition}[Open/Closed street segment]
\label{Def.open/closed/subcritical}
Let $e \in E$ be a street segment and let $\emptyset \neq s \subseteq e$ be a non-empty subset of $e$.\\ Say $s$ is \emph{open} if either of the two following set of conditions are satisfied:
\begin{enumerate}
\item $\vert s \vert \leq r$
\vspace{.2 cm}
\item[]\textbf{OR}
\vspace{.2 cm}
\item $\left\{
\begin{array}{l}
\vert s \vert > r \\
\forall c \subset s, \, (\vert c \vert = r \; \text{and} \; c  \; \text{topologically closed} )\Rightarrow X^{\lambda}(c) \geq 1
\end{array}
\right.$
\end{enumerate}
Say $s$ is \emph{closed} if $s$ is not open, i.e.: \\
 $\left\{
\begin{array}{l}
\vert s \vert > r \\
\exists \, c \subset s, \; \text{such that} \, \vert c \vert = r \; \text{and} \; c  \; \text{topologically closed} \; \text{and} \,  X^{\lambda}(c) = 0
\end{array}
\right.$
\end{Definition}

\section{Results}
Our results concern the phase transition of the connectivity graph corresponding to the model presented in Section~\ref{Ss.NetworkModel} as well as a minimality condition on $p$ to make percolation to occur possible. Namely, we have the following:

\begin{Theorem}[Minimality condition on $p$]
\label{Thm.minimality}
Let $p^{*}$ be the Voronoi percolation site threshold (a theoretical estimate is given in~\cite{neher2008topological} and a numerical one is given in~\cite{becker_percolation_2009}). Let $p < p^*$. Then, for all $\lambda > 0$ and $r >0$, the connectivity graph $\mathcal{G}_{\lambda,r,p}$ does not percolate with probability 1.
\end{Theorem}

Concerning the sub-critical phase, we have the following:
\begin{Theorem}[Existence of a non-trivial sub-critical phase]
\label{Thm.subcritical}
Assume $p=1$. Then there exists $r_{0} > 0$ such that, whenever $r \leq r_0$, we have:
\begin{equation*}
    \lambda_c(r) \coloneqq \inf \lbrace \lambda > 0 : \, \mathbb{P}(\mathcal{G}_{\lambda, r, 1} \; \text{percolates}) > 0 \rbrace > 0
\end{equation*}
In other words, there exists a subcritical phase for percolation of the connectivity graph when all crossroads are equipped with a relay if the connection radius is not too large.
\end{Theorem}

A straightforward consequence of Theorem~\ref{Thm.subcritical} is the following:

\begin{Corollary}
\label{Coroll.subcritical}
Let $r_0$ be defined as in Theorem~\ref{Thm.subcritical}. Then, whenever $r \leq r_{0}$, for all $p \in \left(p^*,1\right]$, we have:
\begin{equation*}
    \inf \lbrace \lambda > 0 : \, \mathbb{P}(\mathcal{G}_{\lambda, r, p} \; \text{percolates}) > 0 \rbrace > 0
\end{equation*}
\end{Corollary}

Finally, we also were able to get a matching super-criticality result:

\begin{Theorem}[Existence of a non-trivial super-critical phase]
\label{Thm.supercritical}
For sufficiently large and finite $\lambda$ and sufficiently large $p > p^*$, $\mathcal{G}_{\lambda,r,p}$ percolates, i.e. there exists a non-trivial super-critical phase.
\end{Theorem}

While Theorem~\ref{Thm.minimality} is quite straightforward, Theorems~\ref{Thm.subcritical} and ~\ref{Thm.supercritical} require the use of renormalization techniques similar to the ones exposed in \cite{hirsch_continuum_2017} and the domination by product measures theorem \cite[Theorem 0.0]{liggett_domination_1997}. \\
We will carry the proofs of the former theorems in the rest of this section.

\subsection{Proof of Theorem~\ref{Thm.minimality}}\mbox{}\\
\indent Let $p^*$ denote the usual Poisson-Voronoi site percolation threshold, as defined in ~\cite{becker_percolation_2009,neher2008topological}. It is known that $p \in \left(0,1\right)$. Note that by stationarity, $p^*$ is independent of the intensity of the PPP generating the considered PVT. Hence, consider site percolation on the PVT $S$ with parameter $p \in \left(0,1\right)$ and denote by $\mathcal{G}_p$ the associated graph. \\
Now, note that for given $p \in \left[0,1\right]$, all $\lambda >0$ and $r>0$, the edge-set of the connectivity graph of our model $\mathcal{G}_{\lambda,r,p}$ is a subset of the edge-set of $\mathcal{G}_p$. 
\\Hence: $\forall \, \lambda >0, \forall \, r>0, \, \mathcal{G}_{p} \ \text{does not percolate} \Rightarrow \, \mathcal{G}_{\lambda, r, p} \ \text{does not percolate}$.
Now, by definition of $p^*$, $\forall \, p < p^*, \, \mathcal{G}_p$ does not percolate. This concludes the proof of Theorem~\ref{Thm.minimality}. \qed
\\
\subsection{Proof of Theorem~\ref{Thm.subcritical}}\mbox{}\\
Proving Theorem~\ref{Thm.subcritical} is equivalent to proving that there exists $r_0$ such that whenever $r \leq r_0$, $\mathcal{G}_{\lambda,r,1}$ does not percolate if $\lambda$ is sufficiently small but positive. \\
As customary in any continuum percolation problem and as has been done in \cite{hirsch_continuum_2017}, we will use a renormalization argument and introduce a discrete percolation model constructed in such a way that if the discrete model does not percolate, then neither does $\mathcal{G}_{\lambda,r,1}$. Proving the absence of percolation of the discrete model will then be done via appealing to \cite[Theorem 0.0]{liggett_domination_1997}. \\
\\
To this end, for $n \geq 1$, say a site $z \in \mathbb{Z}^{2}$ is \emph{n-good} if the following conditions are satisfied: 
\begin{enumerate}
\item $R(Q_n(nz)) < n$
\item $\forall e \in E, \, s_{z,e} \coloneqq e \cap Q_n(nz) \; \text{is closed}$
\end{enumerate}
Say a site $z \in \mathbb{Z}^{2}$ is \emph{$n$-bad} if it is not $n$-good. \\
\\
Our first claim is the following:
\begin{Lemma}
\label{Claim1.subcritical}
Percolation of $\mathcal{G}_{\lambda,r,1}$ implies percolation of the process of $n$-bad sites.
\end{Lemma}
\begin{Proof}
Assume $\mathcal{G}_{\lambda,r,1}$ percolates and denote by $\mathcal{C}$ a giant component of $\mathcal{G}_{\lambda,r,1}$. Since $\mathcal{C}$ is infinite, we have: $\# \lbrace z : \mathcal{C} \cap Q_n(nz) \neq \emptyset \rbrace = + \infty$.
\\ Denote $ \lbrace z : \mathcal{C} \cap Q_n(nz) \neq \emptyset \rbrace \coloneqq \lbrace z_i, i \geq 1 \rbrace$. Note that $\mathcal{C}$ is made of open street segments and open crossroads. Therefore, since $Q_n(nz_i)$ is crossed by $\mathcal{C}$ for all $i \geq 1$, $Q_n(nz_i)$ has to be crossed by some open non-empty $s_e$, for some $e \in  E$. Hence $z_i$ is $n$-bad, and $\lbrace z_i, i \geq 1 \rbrace$ is a infinite component of $n$-bad sites. Now, since $\mathcal{C}$ is connected, then so is $\lbrace z_i, i \geq 1 \rbrace$. Hence, the process of $n$-bad sites percolates. 
\end{Proof}
Therefore, it suffices to prove that the process of $n$-bad sites does not percolate if $\lambda$ and $r$ are sufficiently small. This will be done via appealing to \cite[Theorem 0.0]{liggett_domination_1997}. \\
The conditions of \cite[Theorem 0.0]{liggett_domination_1997} are valid for so-called $k$-dependent random fields:
\begin{Definition}
Let $ \mathbf{X}=(X_s)_{s \in \mathbb{Z}^{d}}$ be a discrete random field. Let $k \geq 1$. Then $\mathbf{X}$ is said to be $k$-dependent if for all $p \geq 1$ and all $\psi = \lbrace s_{1}, \ldots s_{p} \rbrace \subset \mathbb{Z}^{d}$ finite with the property that $\forall i \neq j, \lVert s_{i} - s_{j} \rVert_{\infty} > k $, the random variables $(X_{s_{i}})_{1 \leq i \leq p}$ are independent.
\end{Definition}

As we shall see thereafter, the process of $n$-bad sites previously defined is $3$-dependent:

\begin{Lemma}
For $z \in \mathbb{Z}^{2}$, set $\zeta_{z} \coloneqq \mathbbm{1}\lbrace z \, \text{is $n$-bad} \rbrace$. Then $(\zeta_{z})_{z \in \mathbb{Z}^{2}}$ is a $3$-dependent random field.
\end{Lemma}
\begin{Proof}
As a starting point, note that $\forall z \in \mathbb{Z}^{2}, \zeta_{z} = 1 - \mathbbm{1} \lbrace z \, \text{is $n$-good} \rbrace$. It is therefore equivalent to prove that the process of $n$-good sites is $3$-dependent. \\
For $z \in \mathbb{Z}^{2}$, set $\xi_{z} = \mathbbm{1} \lbrace z \, \text{is $n$-good} \rbrace$. Let $\psi = \lbrace z_{1}, \ldots z_{p} \rbrace \subset \mathbb{Z}^{2}$ be such that $\forall i \neq j, \lVert z_i - z_j \rVert_{\infty} > 3$.
We want to show that the random variables $(\xi_{z_i})_{1\leq i \leq p}$ are independent. Equivalently, since we are dealing with indicator functions, this amounts to showing that: 
$$\mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) = \prod_{i=1}^{p} \mathbb{E}(\xi_{z_i})$$
Now, we have:

\begin{align}
  \nonumber \mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) &= \mathbb{E}\left[\mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \Bigg\vert \Lambda \right)\right] \\ \label{eq2} &= \mathbb{E}\Bigg[\mathbb{E}\Bigg(\prod_{i=1}^{p}\mathbbm{1}\lbrace R(Q_n(nz_i)) < n \rbrace \prod_{i=1}^{p} \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace  \Bigg\vert \Lambda \Bigg) \Bigg] 
\end{align}

By $\Lambda$-measurability of the random variables $\lbrace R_x \rbrace_{x \in \mathbb{R}^2}$, we can take the indicators of the form $\mathbbm{1} \lbrace R(Q_n(nz_i)) < n \rbrace$, $1 \leq i \leq p$ out of the conditional expectation given $\Lambda$ in~\eqref{eq2}. This yields:

\begin{align}
 \label{eq3} \mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) &= \mathbb{E}\Bigg[\prod_{i=1}^{p} \mathbbm{1} \lbrace R(Q_n(nz_i) <n \rbrace \mathbb{E}\Bigg( \prod_{i=1}^{p} \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace  \Bigg\vert \Lambda \Bigg) \Bigg] 
\end{align}
For $1 \leq i \leq p$, set $A_{z_i} \coloneqq \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace \, , 1 \leq i \leq p$. According to Definition~\ref{Def.open/closed/subcritical}, for a given $1 \leq i \leq p$, the event $A_{z_i}$ only depends on the configuration of the random measure $\Lambda$ and of the Cox process $X^{\lambda}$ inside the square $Q_n(nz_i)$. Therefore, given $\Lambda$, the former events only depend on $X^{\lambda} \cap Q_n(nz_i)$ for $1 \leq i \leq p$. Since we have $\forall i \neq j, \lVert z_i - z_j \rVert_{\infty} > 3$, then the squares $Q_n(nz_i) = $ are disjoint. Now, we have that $X^{\lambda}$ is a Poisson Point Process given $\Lambda$. Thus, by Poisson independence property, the events $(A_{z_i})_{1 \leq i \leq p}$ are conditionally independent given $\Lambda$. Hence~\eqref{eq3} yields:
\begin{align}
 \label{eq4} \mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) &= \mathbb{E}\Bigg[\prod_{i=1}^{p} \mathbbm{1} \lbrace R(Q_n(nz_i) <n \rbrace \prod_{i=1}^{p} \mathbb{E}\Bigg(  \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace  \Bigg\vert \Lambda \Bigg) \Bigg] 
\end{align}
Now, setting, $f(\Lambda_{Q_n(x)}) \coloneqq \mathbb{E}\Bigg(  \mathbbm{1} \lbrace \forall \, e \in E, \, s_{x,e} \, \text{is closed} \rbrace  \Bigg\vert \Lambda \Bigg)$, a deterministic, bounded and measurable function of $\Lambda_{Q_n(x)}$ we are left with:
\begin{align}
    \mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) &= \mathbb{E}\left( \prod_{i=1}^{p} f(\Lambda_{Q_n(nz_i)}) \mathbbm{1}\lbrace R(Q_n(nz_i)) <n \rbrace \right) \label{eq5}
\end{align}
Now, the set $\varphi \coloneqq \lbrace nz_1,\ldots,nz_p \rbrace \subset \mathbb{R}^{d}$ is finite and satisfies: $$\forall i \neq j, \lVert nz_i - nz_j \rVert_{\infty} > 3n$$ Since the infinite norm is always upper bounded by the Euclidean norm, we have $\forall i \neq j, \lVert nz_i - nz_j \rVert_{2} > 3n $, and so $\varphi$ satisfies:
$$\forall x \in \varphi, \, \text{dist}(x, \varphi \setminus \lbrace x \rbrace) > 3n$$
We can therefore apply the definition of stabilization  \cite[Definition 2.3]{hirsch_continuum_2017} to get that the random variables appearing in the right-hand side of~\eqref{eq5} are independent. Hence:

\begin{align}
    \nonumber \mathbb{E}\left(\prod_{i=1}^{p} \xi_{z_i} \right) &= \prod_{i=1}^{p} \mathbb{E}\left( f(\Lambda_{Q_n(nz_i)})\mathbbm{1}\lbrace R(Q_n(nz_i)) <n \rbrace \right) \\\nonumber &= \prod_{i=1}^{p} \mathbb{E}\left[  \mathbb{E}\Bigg(  \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace  \Bigg\vert \Lambda \Bigg) \mathbbm{1}\lbrace R(Q_n(nz_i)) <n \rbrace \right] \nonumber \\ &= \prod_{i=1}^{p} \mathbb{E}\left[  \mathbb{E}\Bigg(  \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace \mathbbm{1}\lbrace R(Q_n(nz_i)) <n \rbrace  \Bigg\vert \Lambda \Bigg)   \right]  \label{eq6} \intertext{(where we have used $\Lambda$-measurability of the $R$'s in~\eqref{eq6})} \nonumber  \\ \nonumber &= \prod_{i=1}^{p} \mathbb{E}\left[   \mathbbm{1} \lbrace \forall \, e \in E, \, s_{z_i,e} \, \text{is closed} \rbrace \mathbbm{1}\lbrace R(Q_n(nz_i)) <n \rbrace \right] \\ \nonumber &\eqqcolon \prod_{i=1}^{p} \mathbb{E}(\xi_{z_i}) 
\end{align}
This concludes the proof of the lemma.
\end{Proof}
Now that we have proven that the process of $n$-bad sites is $3$-dependent, in order to apply \cite[Theorem 0.0]{liggett_domination_1997}, it remains to prove that the probability for a site $z \in \mathbb{Z}^{d}$ to be $n$-bad is sufficiently small when $\lambda$ and $r$ are chosen sufficiently small. Equivalently, as has been done in \cite{hirsch_continuum_2017}, we need to prove the following:
\begin{equation*}
    \limsup_{n \uparrow \infty}\limsup_{r \downarrow 0}\limsup_{\lambda \downarrow 0} \mathbb{P}(z \, \text{is $n$-bad}) = 0
\end{equation*}
By stationarity, it suffices to prove that: 
\begin{equation*}
\limsup_{n \uparrow \infty}\limsup_{r \downarrow 0}\limsup_{\lambda \downarrow 0} \mathbb{P}(0 \, \text{is $n$-bad}) = 0
\end{equation*}
Now, note that we have:
\begin{align*}
    \mathbb{P}(0 \, \text{is $n$-bad}) &= \mathbb{P}\Big(\lbrace R(Q_n) \geq n \rbrace \cup \lbrace \exists \, e \in E, \, e \cap Q_n \, \text{is open} \rbrace \Big) \\ & \leq \mathbb{P}\left( R(Q_n) \geq n \right) + \mathbb{P}\left(  \exists \, e \in E, \, e \cap Q_n \, \text{is open} \right)
\end{align*}
On the one hand, we note that the quantity $R(Q_n)$ does not depend on $\lambda$ and $r$ and by Definition~\ref{Def.stabilizing}, we have $\displaystyle \lim_{n \uparrow \infty} \mathbb{P}(R(Q_n) \geq n)  = 0$. \\
Therefore, it remains to deal with the quantity $\mathbb{P}\left(  \exists \, e \in E, \, e \cap Q_n \, \text{is open} \right)$. We have:
\begin{align}
    \nonumber \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right) &= 1 - \mathbb{P}\left(  \forall \, e \in E, \, e \cap Q_n \, \text{is open} \right) \\ \nonumber &= 1 - \mathbb{E}\left( \prod_{e \in E \, : \, e \cap Q_n \neq \emptyset} \mathbbm{1}\lbrace \text{$e \cap Q_n$ is open} \rbrace \right) \\ \nonumber &= 1 - \mathbb{E}\left[\mathbb{E}\left( \prod_{e \in E \, : e \cap Q_n \neq \emptyset} \mathbbm{1}\lbrace \text{$e \cap Q_n$ is closed} \rbrace  \Bigg\vert \Lambda \right) \right] 
\end{align}
For $e \in E$, denote:
\begin{gather*}
    s_e \coloneqq e \cap Q_n \\ A_e \coloneqq \lbrace \exists \, c \subset s_e, \, \text{$c$ topologically closed}, \vert c \vert = r, X^{\lambda}(c) = 0 \rbrace
\end{gather*}
We have: $\mathbbm{1}\lbrace \text{$s_e$ is closed} \rbrace = \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \mathbbm{1}\lbrace A_e \rbrace $. Thus:

\begin{align}
     \nonumber \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right) &= 1 - \mathbb{E}\left[\mathbb{E}\left( \prod_{e \in E \, : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \mathbbm{1}\lbrace A_e \rbrace  \Bigg\vert \Lambda \right) \right] \\ \nonumber &= 1 - \mathbb{E}\left[\prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace\mathbb{E}\left( \prod_{e \in E \, : s_e \neq \emptyset}  \mathbbm{1}\lbrace A_e \rbrace  \Bigg\vert \Lambda \right) \right],  \intertext{by $\Lambda$-measurability of the events $\lbrace \vert s_e > r \vert \rbrace$,\, $e \in E$.} \nonumber
\end{align}
Given $\Lambda$, $X^{\lambda}$ has the distribution of a Poisson point process with mean measure $\lambda \Lambda$ and $A_e$ only depends on $X^{\lambda} \cap e$ once $e$ is fixed. Therefore, given $\Lambda$, the events $\lbrace A_e \, : e \in E \rbrace$ depend on the number of Cox points on distinct edges and so, by the Poisson independence property, these events are conditionally independent given $\Lambda$. Thus: 

\begin{align}
     \nonumber \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right) &= 1 - \mathbb{E}\left[\prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace\mathbb{E}\left( \prod_{e \in E \, : s_e \neq \emptyset}  \mathbbm{1}\lbrace A_e \rbrace  \Bigg\vert \Lambda \right) \right] \\ \nonumber &= 1 - \mathbb{E}\left[\prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \prod_{e \in E \, : s_e \neq \emptyset}\mathbb{E}\left(   \mathbbm{1}\lbrace A_e \rbrace  \vert \Lambda \right) \right] \\ \label{eq7} &= 1 - \mathbb{E}\left[\prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \prod_{e \in E \, : s_e \neq \emptyset}\mathbb{P}\left( A_e  \vert \Lambda \right) \right] 
\end{align}
For all $e \in E$ such that $s_e \neq \emptyset$, we have that $0 \leq \mathbb{P}(A_e \vert \Lambda) \leq 1$, and moreover the event $A_e$ is increasing in $\lambda$ with $\displaystyle \lim_{\lambda \downarrow 0} \mathbbm{1}\lbrace A_e \rbrace = 1 \: \text{a.s.}$. So, by monotone convergence, we have that for all $e \in E$ such that $s_e \neq \emptyset$, $\displaystyle \lim_{\lambda \downarrow 0} \mathbb{P}(A_e \vert \Lambda) = 1 \: \text{a.s.}$. As a matter of fact:
\begin{equation*}
    \limsup_{\lambda \downarrow 0} \prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \prod_{e \in E \, : s_e \neq \emptyset}\mathbb{P}\left(    A_e  \vert \Lambda \right) = \prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \quad \text{a.s.}
\end{equation*}
Noting that $\displaystyle \Bigg\lvert \prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \prod_{e \in E \, : s_e \neq \emptyset}\mathbb{P}\left(    A_e  \vert \Lambda \right) \Bigg\rvert \leq 1$, we can apply dominated convergence in~\eqref{eq7}, we get:
\begin{align}
   \nonumber  \limsup_{\lambda \downarrow 0} \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right) &= 1 - \mathbb{E}\left(\prod_{e \in E : s_e \neq \emptyset} \mathbbm{1}\lbrace \vert s_e \vert > r \rbrace \right) \\ \label{eq8} &= 1 - \mathbb{E}\left(\prod_{e \in E} \mathbbm{1}\lbrace \vert e \cap Q_n \vert > r \rbrace \mathbbm{1} \lbrace e \cap Q_n \neq \emptyset \rbrace \right)
\end{align}
Again, by monotone convergence, we have for all $e \in E$:
\begin{align*}
\lim_{r \downarrow 0} \mathbbm{1}\lbrace \vert e \cap Q_n \vert > r \rbrace \mathbbm{1}\lbrace e \cap Q_n \neq \emptyset \rbrace &= \mathbbm{1}\lbrace \vert e \cap Q_n \vert > 0 \rbrace \mathbbm{1}\lbrace e \cap Q_n \neq \emptyset \rbrace \quad \text{a.s.} \\ &= \mathbbm{1}\lbrace e \cap Q_n \neq \emptyset \rbrace \quad \text{a.s.}
\end{align*} 
So, applying dominated convergence again in~\eqref{eq8} we get:
\begin{equation}
\label{eq9}
   \limsup_{r \downarrow \infty}\limsup_{\lambda \downarrow 0} \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right)=1-\mathbb{E}\left(\prod_{e \in E } \mathbbm{1}\lbrace e \cap Q_n \neq \emptyset \rbrace \right)
\end{equation}
By monotone convergence, $\displaystyle \lim_{n \uparrow \infty}\mathbbm{1}\lbrace e \cap Q_n \neq \emptyset \rbrace = 1 \quad \text{a.s.}$ for all $e \in E$. Therefore, by dominated convergence in~\eqref{eq9}, we obtain:
\begin{equation}
    \label{eq10}
    \limsup_{n \uparrow \infty}\limsup_{r \downarrow 0}\limsup_{\lambda \downarrow 0} \mathbb{P}\left(\exists \, e \in E, \, e \cap Q_n \, \text{is open} \right) = 1-1 = 0
\end{equation}
To conclude, we have: 
\begin{equation*}
    0 \leq \mathbb{P}(0 \, \text{is $n$-bad}) \leq \mathbb{P}(R(Q_n) \geq n) + \mathbb{P}(\exists \, e \in E, \, e \cap Q_n \, \text{is open})
\end{equation*}
Using Definition~\ref{Def.stabilizing} on  and~\eqref{eq10}, we finally get:
\begin{equation*}
     \limsup_{n \uparrow \infty}\limsup_{r \downarrow 0}\limsup_{\lambda \downarrow 0} \mathbb{P}(0 \, \text{is $n$-bad}) =0
\end{equation*}
Hence, by \cite[Theorem 0.0]{liggett_domination_1997}, the process of $n$-bad sites is stochastically dominated from above by a sub-critical Bernoulli process when $\lambda$ and $r$ are sufficiently small. In particular, the process of $n$-bad sites cannot percolate when $\lambda$ and $r$ are sufficiently small. This concludes the proof of Theorem~\ref{Thm.subcritical}. \qed
\bibliographystyle{amsplain}
\bibliography{references}


\end{document} 

